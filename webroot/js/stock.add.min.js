$(function(){let t;$("#__partner-id").blur(function(){$("#items").prop("disabled",!1),partners[$("#partner-id").val()]||$("#sale").prop("checked",!1)}),$(document).on("focus","input.quantity",function(){t=$(this).parent().parent().prev().prev().find("input[type=hidden]").val();let e=products[t][4],n=products[t][5];$(this).parent().parent().next().html(number_format(e)+" / "+number_format(n)),$(this).parent().parent().next().next().html(number_format(n*(1+partners[$("#partner-id").val()]/100))),$(this).parent().parent().next().next().next().find("input").val(number_format(n*(1+partners[$("#partner-id").val()]/100))),$(this).parent().parent().next().next().next().next().next().text(products[t][3]+" %")}),$(document).on("blur","input.price",function(){let n=str2Num($("input.quantity").val())*str2Num($(this).val());$(this).parent().parent().next().text(number_format(n));let r=n*(products[t][3]/100);$(this).parent().parent().next().next().next().text(number_format(r)),$(this).parent().parent().next().next().next().next().text(number_format(n+r)),e($(this).closest("tbody"))});let e=function(t){$("tfoot tr").children().each(function(t,e){let n=0;6!=t&&8!=t&&9!=t||($(e).closest("table").find("tbody tr td:nth-child("+(t+1)+")").each(function(t,e){n+=str2Num($(e).text())}),$(e).text(number_format(n)))});let e=t.children("tr:first"),n=t.children("tr").length;e=e.prop("outerHTML").replace(/items\-0/g,"items-"+n).replace(/items\[0\]/g,"items["+n+"]").replace(/ value="[!"]*"/,' value=""').replace(/td class="text-right">[0-9\.,\/ %]*?<\/td/g,'td class="text-right"></td'),t.append(e),t.find("datalist:last").prev().focus()}});